

  
    
  


  





  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.31.1">
    <meta name="theme" content="Tranquilpeak 0.3.1-BETA">
    <title>Prometheus Blog Series (Part 5): Alerting rules</title>
    <meta name="author" content="Pierre Vincent">
    <meta name="keywords" content="monitoring, prometheus, observability, cloud native, devops, sre, monitoring">

    <link rel="icon" href="https://pierrevincent.github.io/favicon.png">
    

    
    <meta name="description" content="Instrumented applications bring in a wealth of information on how they behave. In the previous parts of this blog series, the focus has been mostly on getting applications to expose their metrics and on how to query Prometheus to make sense of these metrics. This exploratory approach is extremely valuable to uncover unknown unknowns, either pro-actively (testing) or reactively (debugging).

Metrics can also be used to help with things we already know and care about: instrumenting those things and knowing what is their normal state, then it’s possible to alert on situations that are judged problematic. Prometheus makes this possible through the definition of alerting rules.

">
    <meta property="og:description" content="Instrumented applications bring in a wealth of information on how they behave. In the previous parts of this blog series, the focus has been mostly on getting applications to expose their metrics and on how to query Prometheus to make sense of these metrics. This exploratory approach is extremely valuable to uncover unknown unknowns, either pro-actively (testing) or reactively (debugging).

Metrics can also be used to help with things we already know and care about: instrumenting those things and knowing what is their normal state, then it’s possible to alert on situations that are judged problematic. Prometheus makes this possible through the definition of alerting rules.

">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Prometheus Blog Series (Part 5): Alerting rules">
    <meta property="og:url" content="/2017/12/prometheus-blog-series-part-5-alerting-rules/">
    <meta property="og:site_name" content="Pierre Vincent">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Prometheus Blog Series (Part 5): Alerting rules">
    <meta name="twitter:description" content="Instrumented applications bring in a wealth of information on how they behave. In the previous parts of this blog series, the focus has been mostly on getting applications to expose their metrics and on how to query Prometheus to make sense of these metrics. This exploratory approach is extremely valuable to uncover unknown unknowns, either pro-actively (testing) or reactively (debugging).

Metrics can also be used to help with things we already know and care about: instrumenting those things and knowing what is their normal state, then it’s possible to alert on situations that are judged problematic. Prometheus makes this possible through the definition of alerting rules.

">
    
      <meta name="twitter:creator" content="@PierreVincent">
    
    

    
    

    
      <meta property="og:image" content="https://s.gravatar.com/avatar/44d398d6974d29619c2dfc37428fc5ab?s=250">
    

    
      <meta property="og:image" content="https://pierrevincent.github.io/images/prometheus.png">
    
    
    

    

    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" />
    
    
    <link rel="stylesheet" href="https://pierrevincent.github.io/css/style-u6mk0ojoywresbx8iepslrmmhl4stuhrsxuwhkpwrkrx7mryjcaimasnk4pi.min.css" />
    
    
      <link rel="stylesheet" href="https://pierrevincent.github.io/css/style.css">
    

    
      
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-104104349-1', 'auto');
ga('send', 'pageview');
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://pierrevincent.github.io/">Pierre Vincent</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://pierrevincent.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://s.gravatar.com/avatar/44d398d6974d29619c2dfc37428fc5ab?s=250" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://pierrevincent.github.io/#about">
          <img class="sidebar-profile-picture" src="https://s.gravatar.com/avatar/44d398d6974d29619c2dfc37428fc5ab?s=250" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Pierre Vincent</h4>
        
          <h5 class="sidebar-profile-bio">SRE Manager / Observability addict</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://pierrevincent.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://pierrevincent.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://pierrevincent.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://pierrevincent.github.io/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://pierrevincent.github.io/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/PierreVincent" target="_blank">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/PierreVincent" target="_blank">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://pierrevincent.github.io/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      Prometheus Blog Series (Part 5): Alerting rules
    </h1>
  
  <div class="postShorten-meta post-meta">
  
    <time itemprop="datePublished" datetime="2017-12-31T00:00:00Z">
      
  December 31, 2017

    </time>
  
  
  
  
    <span>in</span>
    
      <a class="category-link" href="https://pierrevincent.github.io/categories/monitoring">monitoring</a>
    
  


</div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>Instrumented applications bring in a wealth of information on how they behave. In the previous parts of this <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-1-metrics-and-labels/">blog series</a>, the focus has been mostly on getting applications to expose their metrics and on how to query Prometheus to make sense of these metrics. This exploratory approach is extremely valuable to uncover <em>unknown unknowns</em>, either pro-actively (testing) or reactively (debugging).</p>

<p>Metrics can also be used to help with things we already know and care about: instrumenting those things and knowing what is their <em>normal</em> state, then it’s possible to alert on situations that are judged problematic. Prometheus makes this possible through the definition of alerting rules.</p>

<p></p>

<p><em>Important: examples in this post follow the new rules syntax from Prometheus 2.0. If you haven&rsquo;t upgraded yet, you can refer to the <a href="https://prometheus.io/docs/prometheus/1.8/configuration/alerting_rules/">Prometheus 1.x documentation</a>.</em></p>

<h2 id="defining-thresholds-to-alert-on">Defining thresholds to alert on</h2>

<p>Continuing the jobs queue example from <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-4-instrumenting-code-in-go-and-java/">Part 4</a>, the following rule is creating an alert if the total number of jobs in the queue is above 100. This threshold is obviously arbitrary (and the example simplistic) and would need to be based on the understanding of what <em>normal</em> looks like for the metric used.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">alert:<span style="color:#bbb"> </span>Lots_Of_Jobs_In_Queue<span style="color:#bbb">
</span><span style="color:#bbb"></span>expr:<span style="color:#bbb"> </span>sum(jobs_in_queue)<span style="color:#bbb"> </span><span style="color:#a50">&gt; 100</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>for:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb"></span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">   </span>severity:<span style="color:#bbb"> </span>major</code></pre></div>
<p>In the above example, the <code>expr</code> field specifies the metric query and threshold under which this alert should fire, i.e. when the queue size is greater than 100.</p>

<p>The <code>for</code> field is used to delay the alert from triggering, in order to avoid spurious alerts when the threshold is only reached for a short period of time before returning to normal. In this case, <code>5m</code> means that if the queue size goes over 100, the alert will be set to <em>Pending</em> and remain that way if it doesn’t recover. After 5 minutes, it will be set to <em>Firing</em> and the relevant notifications will be triggered.</p>

<p>Prometheus itself does not send the actual alert messages to users, this is the responsibility of the <a href="https://prometheus.io/docs/alerting/alertmanager/">Alertmanager</a> (deployed independently). When an alert reaches the <em>Firing</em> state, Prometheus notifies the Alertmanager, which in turn will route the alert to the right channel (e.g. Slack, Pagerduty&hellip;) and to the right people. Alertmanager routing will be covered in the next post of this series.</p>

<h3 id="a-word-on-namespacing-queries-in-alerting-rules">A word on namespacing queries in alerting rules</h3>

<p>As Prometheus stores all metrics together, the metric named <code>jobs_in_queue</code> could come from different services to represent something different in their own context. Using <code>sum(jobs_in_queue)</code> could therefore create false positive if suddenly a new service started using the same metric name (without knowing it was already used by a different team).</p>

<p>In order to avoid this, it is best to filter the metric with a specific label for the services the alert related to, e.g. <code>sum(jobs_in_queue{service=&quot;billing-processing&quot;}) &gt; 100</code>.</p>

<p>An alternative approach is to keep the <code>service</code> label so it can be used later on to silence alerts, e.g. <code>sum(jobs_in_queue) by (service)</code>.</p>

<h2 id="provide-context-to-facilitate-resolution">Provide context to facilitate resolution</h2>

<p>Nobody wants to be woken up in the middle of the night by a critical alert. Unfortunately, the complexity of distributed applications and the underlying infrastructure means that sometimes things go wrong. In order to facilitate the mitigation and resolution of an incident, it is crucial to provide the on-call person with as much context as possible, for example:</p>

<ul>
<li>A short description of what was actually detected</li>
<li>The impact of the detected problem (Are customers affected? Are they about to be affected?)</li>
<li>Is there anything that can be done to quickly mitigate the issue? (while investigating for a more durable fix)</li>
<li>Dashboards with more in-depth information</li>
<li>A list of likely contributing causes</li>
<li>Steps to investigate</li>
</ul>

<p>These things can be thought through quickly when the alert is defined and will make the on-call person’s life much easier. Even if you are both defining the alert and responding to it, will you remember the context at 4:00am, 6 months from now?</p>

<p>Prometheus alerting rules can be enriched with this kind of metadata using <em>annotations</em>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">alert:<span style="color:#bbb"> </span>Lots_Of_Billing_Jobs_In_Queue<span style="color:#bbb">
</span><span style="color:#bbb"></span>expr:<span style="color:#bbb"> </span>sum(jobs_in_queue{service=<span style="color:#a50">&#34;billing-processing&#34;</span>})<span style="color:#bbb"> </span><span style="color:#a50">&gt; 100</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>for:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb"></span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">   </span>severity:<span style="color:#bbb"> </span>major<span style="color:#bbb">
</span><span style="color:#bbb"></span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">   </span>summary:<span style="color:#bbb"> </span>Billing<span style="color:#bbb"> </span>queue<span style="color:#bbb"> </span>appears<span style="color:#bbb"> </span>to<span style="color:#bbb"> </span>be<span style="color:#bbb"> </span>building<span style="color:#bbb"> </span>up<span style="color:#bbb"> </span>(consistently<span style="color:#bbb"> </span>more<span style="color:#bbb"> </span>than<span style="color:#bbb"> </span><span style="color:#099">100</span><span style="color:#bbb"> </span>jobs<span style="color:#bbb"> </span>waiting)<span style="color:#bbb">
</span><span style="color:#bbb">   </span>dashboard:<span style="color:#bbb"> </span>https://grafana.monitoring.intra/dashboard/db/billing-overview<span style="color:#bbb">
</span><span style="color:#bbb">   </span>impact:<span style="color:#bbb"> </span>Billing<span style="color:#bbb"> </span>is<span style="color:#bbb"> </span>experiencing<span style="color:#bbb"> </span>delays,<span style="color:#bbb"> </span>causing<span style="color:#bbb"> </span>orders<span style="color:#bbb"> </span>to<span style="color:#bbb"> </span>be<span style="color:#bbb"> </span>marked<span style="color:#bbb"> </span>as<span style="color:#bbb"> </span>pending<span style="color:#bbb">
</span><span style="color:#bbb">   </span>runbook:<span style="color:#bbb"> </span>https://wiki.intra/runbooks/billing-queues-issues.html</code></pre></div>
<p>As the above example shows, annotations can be used to provide important information up-front (summary and impact), while also linking through additional resources (dashboards and runbooks) that will help the responder focusing on the problem, as opposed to spending time searching wiki pages.</p>

<h3 id="grouping-rules">Grouping rules</h3>

<p>Prometheus 2.0 introduces the concept of <em>rule group</em> when configuring alerting rules (as well recording rules, which are covered below):</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">groups:<span style="color:#bbb">
</span><span style="color:#bbb"></span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>batch_jobs<span style="color:#bbb">
</span><span style="color:#bbb">  </span>rules:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>alert:<span style="color:#bbb"> </span>Lots_Of_Jobs_In_Queue<span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span>...<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>alert:<span style="color:#bbb"> </span>Jobs_Taking_Longer_Than_Expected<span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span>...<span style="color:#bbb">
</span><span style="color:#bbb"></span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>frontend_health<span style="color:#bbb">
</span><span style="color:#bbb">  </span>rules:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>alert:<span style="color:#bbb"> </span>Frontend_High_Latency<span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span>...<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>alert:<span style="color:#bbb"> </span>Frontend_High_ErrorRate<span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span>...</code></pre></div>
<p>All the rules in a group are processed sequentially, while all groups are processed in parallel. By default, the rule processing follows the <code>evaluation_interval</code> duration from the Prometheus configuration, but groups can individually override this setting. This is useful if some rules are more expensive and should then be processed less often.</p>

<h3 id="difference-between-recording-rules-and-alerting-rules">Difference between recording rules and alerting rules</h3>

<p>In addition to alerting rules, Prometheus also allows the definition of recording rules. Recording rules are evaluated just like alerting rules but instead of creating notifications, they generate new metrics that can be queried.</p>

<p>These <em>pre-calculated</em> queries can be re-used in other rules (including alerting rules) and for dashboards, without the performance impact of repeating the query each time.</p>

<p>For example, the following group creates a new metric to pre-calculate the 99th percentile of the duration of each <code>job_type</code>, which can be reused to trigger alerts of different severity (without calculating the quantile twice).</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">groups:<span style="color:#bbb">
</span><span style="color:#bbb"></span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>billing_jobs_health<span style="color:#bbb">
</span><span style="color:#bbb">  </span>rules:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>record:<span style="color:#bbb"> </span><span style="color:#a50">&#34;job_type:billing_jobs_duration_seconds:99p5m&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span>histogram_quantile(<span style="color:#099">0.99</span>,<span style="color:#bbb"> </span>sum(rate(jobs_duration_seconds_bucket{service=<span style="color:#a50">&#34;billing-processing&#34;</span>}[5m]))<span style="color:#bbb"> </span>by<span style="color:#bbb"> </span>(job_type))<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>alert:<span style="color:#bbb"> </span>Billing_Processing_Very_Slow<span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span><span style="color:#a50">&#34;job_type:billing_jobs_duration_seconds:99p5m &gt; 30&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>for:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb">    </span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">       </span>severity:<span style="color:#bbb"> </span>critical<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>alert:<span style="color:#bbb"> </span>Billing_Processing_Slow<span style="color:#bbb">
</span><span style="color:#bbb">    </span>expr:<span style="color:#bbb"> </span><span style="color:#a50">&#34;job_type:billing_jobs_duration_seconds:99p5m &gt; 15&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>for:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb">    </span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">       </span>severity:<span style="color:#bbb"> </span>major</code></pre></div>
<p>Naming convention for recording rules differ from standard metrics, they should follow the pattern <code>level:metric:operations</code>. This is explained in more details in the <a href="https://prometheus.io/docs/practices/rules/">Prometheus best practices</a> documentation.</p>

<h2 id="what-s-next">What’s next?</h2>

<p>In this post, we focused on how to define alerting rules using metrics and thresholds, as well as how to make these alerts understandable and helpful. However, alerting on the right things is complicated! So much so that it would probably deserve its own post(s) - I might get to it at some point, but in the meantime, there are excellent resources on the subject:</p>

<ul>
<li>The <a href="https://landing.google.com/sre/book/chapters/monitoring-distributed-systems.html">Monitoring Distributed Systems</a> chapter from the Google SRE Book.</li>
<li>The <a href="https://docs.google.com/document/d/199PqyG3UsyXlwieHaqbGiWVa8eMWi8zzAn0YfcApr8Q/edit">My philosophy on alerting</a> paper by Rob Ewaschuk (foundation of the above chapter in the SRE book)</li>
<li><a href="https://www.youtube.com/watch?v=lC5SfTMFK3M">Avoiding Alerts Overload from Microservices</a> talk at QCon London 2017, by <a href="https://twitter.com/sarahjwells">Sarah Wells</a></li>
</ul>

<p>As explained earlier in this post, Prometheus is only responsible for the rule evaluation and does not actually send alerts - for more information about send and routing alerts, you can refer to the <a href="https://prometheus.io/docs/alerting/configuration/">Alertmanager Configuration</a> documentation.</p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://pierrevincent.github.io/tags/monitoring/">monitoring</a>

  <a class="tag tag--primary tag--small" href="https://pierrevincent.github.io/tags/observability/">observability</a>

  <a class="tag tag--primary tag--small" href="https://pierrevincent.github.io/tags/prometheus/">prometheus</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-4-instrumenting-code-in-go-and-java/" data-tooltip="Prometheus Blog Series (Part 4): Instrumenting code in Go and Java">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Pierre Vincent. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-4-instrumenting-code-in-go-and-java/" data-tooltip="Prometheus Blog Series (Part 4): Instrumenting code in Go and Java">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <ul class="share-options">
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
        <i class="fa fa-google-plus"></i><span>Share on Google Plus</span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
        <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fpierrevincent.github.io%2f2017%2f12%2fprometheus-blog-series-part-5-alerting-rules%2f">
        <i class="fa fa-twitter"></i><span>Share on Twitter</span>
      </a>
    </li>
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://s.gravatar.com/avatar/44d398d6974d29619c2dfc37428fc5ab?s=250" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Pierre Vincent</h4>
    
      <div id="about-card-bio">SRE Manager / Observability addict</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        SRE Manager at Poppulo
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Cork, Ireland
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-5-alerting-rules/">
                <h3 class="media-heading">Prometheus Blog Series (Part 5): Alerting rules</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>Instrumented applications bring in a wealth of information on how they behave. In the previous parts of this <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-1-metrics-and-labels/">blog series</a>, the focus has been mostly on getting applications to expose their metrics and on how to query Prometheus to make sense of these metrics. This exploratory approach is extremely valuable to uncover <em>unknown unknowns</em>, either pro-actively (testing) or reactively (debugging).</p>

<p>Metrics can also be used to help with things we already know and care about: instrumenting those things and knowing what is their <em>normal</em> state, then it’s possible to alert on situations that are judged problematic. Prometheus makes this possible through the definition of alerting rules.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-4-instrumenting-code-in-go-and-java/">
                <h3 class="media-heading">Prometheus Blog Series (Part 4): Instrumenting code in Go and Java</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>So far in this <a href="https://prometheus.io/">Prometheus</a> blog series, we have looked into Prometheus metrics and labels (see <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-1-metrics-and-labels/">Part 1</a> &amp; <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-2-metric-types/">2</a>), as well as how Prometheus integrates in a distributed architecture (see <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-3-exposing-and-collecting-metrics/">Part 3</a>). In this 4th part, it is time to look at code to create custom instrumentation. Luckily, client libraries make this pretty easy, which is one of the reasons behind Prometheus&rsquo; wide adoption.</p>

<p>This post will go through examples in Go and Java. Prometheus has a number of other <a href="https://prometheus.io/docs/instrumenting/clientlibs/">supported languages</a>, through official libraries and community maintained ones.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-3-exposing-and-collecting-metrics/">
                <h3 class="media-heading">Prometheus Blog Series (Part 3): Exposing and collecting metrics</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>In <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-1-metrics-and-labels/">Part 1</a> and <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-2-metric-types/">Part 2</a> of this series, we covered the basics of <a href="https://prometheus.io/">Prometheus</a> metrics and labels. This third part will concentrate on the way Prometheus collects metrics and how clients expose them.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-2-metric-types/">
                <h3 class="media-heading">Prometheus Blog Series (Part 2): Metric types</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>In <a href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-1-metrics-and-labels/">Part 1</a> of this series, we talked about <a href="https://prometheus.io/">Prometheus</a> metrics and how to make good use of labels to observe your applications under different segments and dimensions. This second part will look into more details in the 4 different types of Prometheus metrics: Counters, Gauges, Histograms and Summaries.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/12/prometheus-blog-series-part-1-metrics-and-labels/">
                <h3 class="media-heading">Prometheus Blog Series (Part 1): Metrics and Labels</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>When it comes to monitoring tools in the last while, <a href="https://prometheus.io/">Prometheus</a> is definitely hard to miss. It has quickly risen to be top of the class, with overwhelming adoption from the community and integrations with all the major pieces of the Cloud Native puzzle.</p>

<p>Throughout this blog series, we will be learning the basics of Prometheus and how Prometheus fits within a service-oriented architecture.  This first post the series will cover the main concepts used in Prometheus: metrics and labels.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/09/code-stockholm-highlights-data-driven-devops-and-raising-the-continuous-delivery-game/">
                <h3 class="media-heading">CODE Stockholm Highlights: Data-driven DevOps and raising the Continuous Delivery game</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p><a href="http://www.code-conf.com/code-conf-17/sthlm/">CODE Stockholm</a> is a one-day conference centered on Continuous Delivery and the DevOps movement. Both aspects were well covered through keynotes and two tracks of great talks.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/09/measurement-is-the-number-one-ally-of-technical-work/">
                <h3 class="media-heading">Measurement is the number one ally of technical work</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>As engineers, we tend to have high expectations of product managers to justify the value of adding new features. What problem is this solving? How will we validate that we&rsquo;re building the right thing? Is this the most important thing to work on right now?</p>

<p>These are great questions but interestingly we aren&rsquo;t always applying the same rigor to the technical work.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/06/increasing-the-visibility-of-distributed-systems-in-production/">
                <h3 class="media-heading">Increasing the visibility of distributed systems in production</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>This talk from <a href="http://rebelcon2017.com">RebelCon 2017</a> gives an overview of different monitoring patterns and how different tools can be used to help build a fuller picture of distributed applications in production.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/05/microservices-in-a-fast-paced-customer-centric-environment-how-and-why/">
                <h3 class="media-heading">Microservices in a fast-paced customer-centric environment: How and Why?</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>In this talk at <a href="http://www.tmforumlive.org/">TMForumLive 2017</a>, I describe the <a href="https://www.poppulo.com">Poppulo</a> journey (and challenges!) from a single team building a monolithic application to six teams practicing DevOps on a microservices architecture.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://pierrevincent.github.io/2017/03/increasing-collaboration-and-confidence-with-consumer-driven-contracts-testing/">
                <h3 class="media-heading">Increasing collaboration and confidence with Consumer-Driven Contracts testing</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Mar 3, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>This talk at <a href="https://web.pipelineconf.info">Pipeline, the Continuous Delivery conference</a> covers how we made Consumer-driven contracts and <a href="https://docs.pact.io/">Pact</a> part of our pipeline at <a href="https://www.poppulo.com">Poppulo</a> and how it improved confidence and collaboration between teams when designing APIs.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         13 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('https://pierrevincent.github.io/images/cover.jpg');"></div>
  


    
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.js"></script>


<script src="https://pierrevincent.github.io/js/script-wl33z0n6ocaypepiqrazthtivfrliqijej4rq8ek8gvrv1awftmgjuv8k4zc.min.js"></script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight').each(function(i, block) {
    var code = "";
    hljs.highlightAuto(block.innerText).value.split(/\r\n|\r|\n/).forEach(function(line) {
      code += "<span class=\"line\">" + line + "</span><br>";
    });
    if (code.length > 0) {
      block.innerHTML = code;  
    }
  });
  $('pre > code').each(function(i, block) {
    $(this).addClass('codeblock');
    hljs.highlightBlock(block);
  });
});
</script>

  
    
  





    
  </body>
</html>

